% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/S-MiXcan.R
\name{run_S_MiXcan_r}
\alias{run_S_MiXcan_r}
\title{Run S-MiXcan with Shrinkage Regularization}
\usage{
run_S_MiXcan_r(W1, W2, gwas_results, x_g, ld_ref, n0, n1, family)
}
\arguments{
\item{W1}{A p-by-1 matrix of predicted weights for cell-type 1 (p: number of SNPs).}

\item{W2}{A p-by-1 matrix of predicted weights for cell-type 2.}

\item{gwas_results}{A list with components \code{Beta} (effect sizes) and \code{se_Beta} (standard errors).}

\item{x_g}{A genotype matrix (individuals Ã— SNPs) from reference panel.}

\item{ld_ref}{A p-by-p LD covariance matrix from the reference panel.}

\item{n0}{Number of controls.}

\item{n1}{Number of cases.}

\item{family}{A string, either \code{"binomial"} or \code{"gaussian"}, passed to \code{glm()}.}
}
\value{
A list with the following components:
\describe{
  \item{p_1_sep}{P-value for cell-type 1 (separate test)}
  \item{p_2_sep}{P-value for cell-type 2 (separate test)}
  \item{p_sep}{Combined p-value (ACAT) from separate tests}
  \item{p_1_join}{P-value for cell-type 1 (joint test)}
  \item{p_2_join}{P-value for cell-type 2 (joint test)}
  \item{p_join}{Combined p-value (ACAT) from joint test}
  \item{Z_1_join}{Z-score for cell-type 1 in joint test}
  \item{Z_2_join}{Z-score for cell-type 2 in joint test}
}
}
\description{
Performs cell-type-aware TWAS using GWAS summary statistics, reference LD matrix, and estimated expression weights.
This function estimates the association signal using a shrinkage-regularized inverse of the \( Y^T Y \) matrix,
which improves numerical stability and handles near-collinearity between predictors.
}
